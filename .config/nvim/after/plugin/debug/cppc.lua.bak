local dap = require('dap')

dap.adapters.cppdbg = {
  id = 'cppdbg',
  type = 'executable',
  command = '/home/pabloqpacin/.local/share/nvim/mason/packages/cpptools/extension/debugAdapters/bin/OpenDebugAD7',
}

dap.configurations.cpp = {
    {
        name = "Build and run",
        type = "cppdbg",
        request = "launch",
    }
}


--[[
dap.adapters.cppdbg = {
  id = 'cppdbg',
  type = 'executable',
  --command = '/absolute/path/to/cpptools/extension/debugAdapters/bin/OpenDebugAD7',
  command = '/home/pabloqpacin/.local/share/nvim/mason/packages/cpptools/extension/debugAdapters/bin/OpenDebugAD7',
}

dap.configurations.cpp = {
  {
    name = "Build tasks",
    type = "cppdbg",
    key = "supdawg",
    label = "C/C++: g++ build active file",
    command = "/usr/bin/g++",
    args = {
      "-fdiagnostics-color=always",
      "-g",
      "${file}",
      "-o",
      "${fileDirname}/${fileBasenameNoExtension}",
      "-ftime-report",
      "-Wall",
      "-Wextra",
      "-Wpedantic",
      "-Wuninitialized",
      "-Wnarrowing",
      "-Wconversion",
      "-Wenum-conversion",
      "-Wswitch",
      "-Wswitch-enum",
      "-Wmissing-declarations",
    },
    options = { cwd = "${fileDirname}"},
    problemMatcher = "$gcc",
    group = {
      kind = "build",
      isDefault = true,
    },
    detail = "Task generated by Debugger"
  },
  {
    name = "Launch file",
    type = "cppdbg",
    request = "launch",
    program = function()
      return vim.fn.input('Path to executable: ', vim.fn.getcwd() .. '/', 'file')
    end,
    cwd = '${workspaceFolder}',
    stopAtEntry = true,
  },
  {
    name = 'Attach to gdbserver :1234',
    type = 'cppdbg',
    request = 'launch',
    MIMode = 'gdb',
    miDebuggerServerAddress = 'localhost:1234',
    miDebuggerPath = '/usr/bin/gdb',
    cwd = '${workspaceFolder}',
    program = function()
      return vim.fn.input('Path to executable: ', vim.fn.getcwd() .. '/', 'file')
    end,
  },
}
--]]
--[[
dap.adapters.codelldb = {
  type = 'server',
  port = "${port}",
  executable = {
    -- CHANGE THIS to your path!
    command = '/home/pabloqpacin/.local/share/nvim/mason/packages/codelldb/extension/adapter/codelldb',
    args = {"--port", "${port}"},
  }
}

dap.configurations.cpp = {
  {
    name = "Build and run tasks",
    type = "codelldb",
    label = "C/C++: g++ build active file",
    command = "/usr/bin/g++",
    args = {
      "-fdiagnostics-color=always",
      "-g",
      "${file}",
      "-o",
      "${fileDirname}/${fileBasenameNoExtension}",
      "-ftime-report",
      "-Wall",
      "-Wextra",
      "-Wpedantic",
      "-Wuninitialized",
      "-Wnarrowing",
      "-Wconversion",
      "-Wenum-conversion",
      "-Wswitch",
      "-Wswitch-enum",
      "-Wmissing-declarations",
    },
    options = { cwd = "${fileDirname}"},
    problemMatcher = "$gcc",
    group = {
      kind = "build",
      isDefault = true,
    },
    detail = "Task generated by Debugger"
  },
  {
    name = "Launch file",
    type = "codelldb",
    request = "launch",
    program = function()
      return vim.fn.input('Path to executable: ', vim.fn.getcwd() .. '/', 'file')
    end,
    cwd = '${workspaceFolder}',
    stopOnEntry = false,
  },
}
--]]
